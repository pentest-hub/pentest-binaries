from Crypto.Cipher import ARC4
import sys
import os

def rc4_encrypt(file_path, key):
    try:
        # Sicherstellen, dass die Datei existiert
        if not os.path.isfile(file_path):
            print(f"Fehler: Datei '{file_path}' nicht gefunden.")
            return

        # Dateiinhalt lesen
        with open(file_path, 'rb') as file:
            file_data = file.read()

        # RC4-Cipher initialisieren
        cipher = ARC4.new(key)

        # Dateiinhalt verschlüsseln
        encrypted_data = cipher.encrypt(file_data)

        # Verschlüsselte Datei speichern
        encrypted_file_path = file_path + ".enc"
        with open(encrypted_file_path, 'wb') as encrypted_file:
            encrypted_file.write(encrypted_data)

        print(f"Datei erfolgreich verschlüsselt und unter '{encrypted_file_path}' gespeichert.")

    except Exception as e:
        print(f"Ein Fehler ist aufgetreten: {e}")

if __name__ == "__main__":
    if len(sys.argv) != 3:
        print("Verwendung: python script.py <dateipfad> <schlüssel>")
        sys.exit(1)

    file_path = sys.argv[1]
    key = sys.argv[2].encode()  # Schlüssel in Bytes umwandeln

    rc4_encrypt(file_path, key)
